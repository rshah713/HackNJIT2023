#: import rgba kivy.utils.rgba
#: import Colors colors.Colors
<EMSLogin>:
    name: 'ems login'
        
    ############################## LOGIN LABEL ##############################
    GridLayout:
        cols: 1
        
        pos_hint: {"top": 1}
        size_hint_y: 0.3
        padding: 0, 50, 0, 25
        
        Label:
            text: "EMS Login"
            font_size: min(self.width*0.3, self.height) * 0.4
            font_name: 'Roboto-Bold'
            color: rgba(Colors.BLUE)
                
    BoxLayout:
        orientation: 'vertical'
        pos_hint: {'top': .7}
        size_hint_y: .7


   ############################## EMAIL ##############################
        Label:
            text: "Email:"
            color: rgba(Colors.BLUE)
            font_size: min(self.width*0.4, self.height) * 0.8
            size_hint: (.1, .05)
            pos_hint: {'x': 0.15}
        TextInput:
            id: email
            size_hint: (.7, .1)
            pos_hint: {'x': 0.15}
            multiline: False
            text: ""
            font_size: min(self.width*0.4, self.height) * 0.8
            background_color: rgba(*Colors.BLUE, 0)
            foreground_color: rgba(Colors.ACCENT_BLUE)

            canvas.after:
                Color:
                    rgb: rgba(Colors.BLUE)
                Line:
                    width: 2
                    rectangle: self.x, self.y, self.width, self.height


        Widget:
            size_hint_y: 0.1

        ############################## PASSWORD ##############################

        Label:
            text: "Password:"
            font_size: min(self.width*0.4, self.height) * 0.8
            color: rgba(Colors.BLUE)
            size_hint: (.1, .05)
            pos_hint: {'x': 0.15}
        TextInput:
            id: passw
            size_hint: (.7, .1)
            pos_hint: {'x': 0.15}
            password: True
            multiline: False
            text: ""
            font_size: min(self.width*0.4, self.height) * 0.8
            background_color: rgba(*Colors.BLUE, 0)
            foreground_color: rgba(Colors.ACCENT_BLUE)

            canvas.after:
                Color:
                    rgb: rgba(Colors.BLUE)
                Line:
                    width: 2
                    rectangle: self.x, self.y, self.width, self.height
                        
        Widget:
            size_hint_y: 0.1
                        
        ############################## PASSWORD ##############################

        Label:
            text: "EMS ID:"
            font_size: min(self.width*0.4, self.height) * 0.8
            color: rgba(Colors.BLUE)
            size_hint: (.1, .05)
            pos_hint: {'x': 0.15}
        TextInput:
            id: ems_id
            size_hint: (.7, .1)
            pos_hint: {'x': 0.15}
            multiline: False
            text: ""
            font_size: min(self.width*0.4, self.height) * 0.8
            background_color: rgba(*Colors.BLUE, 0)
            foreground_color: rgba(Colors.ACCENT_BLUE)

            canvas.after:
                Color:
                    rgb: rgba(Colors.BLUE)
                Line:
                    width: 2
                    rectangle: self.x, self.y, self.width, self.height

        ############################## NEW ACCOUNT BUTTON ##############################        
        Button:
            size_hint: (.3, .1)
            pos_hint: {'x': 0.55}

            text: "New Account"
            font_size: min(self.width*0.23, self.height) * 0.65
            color: rgba(Colors.BLUE)
            background_normal: ''
            background_color: rgba(*Colors.BLUE, 0)
            on_press: root.manager.current = 'ems signup'

        Widget:
            size_hint_y: 0.1

        ############################## DONE BUTTON ##############################    
        Button:
            size_hint: (.3, .2)
            pos_hint: {'center_x': 0.5}
            on_release:
                root.manager.current = 'ems dinput' if root.login(email.text, passw.text, ems_id, errorlbl) else 'ems login'


            color: rgba(Colors.BLUE)
            background_normal: '' #https://stackoverflow.com/a/49100826/12514570
            text: 'Login'
            font_size: min(self.width*0.23, self.height) * 0.5

            background_color: rgba(Colors.LIGHT_BLUE)
#                 background_down: 'assets/orange_button_down.png'


            canvas.before:
                Color:
                    rgb: rgba(Colors.BLUE)
                Line:
                    width: 3
                    rectangle: self.x, self.y, self.width, self.height
                        
                        
        ############################## ERROR LABEL ##############################
        Label:
            id: errorlbl
            text: ""
            color: rgba(255, 0, 0)
            font_size: min(self.width*0.23, self.height) * 0.5
            size_hint_y: .2
            pos_hint: {'center_y': 0.3}
                
        ############################## LOGO HERE ##############################        
        Button:
            size_hint_y: .2
            background_normal: ''
            background_color: rgba(237, 151, 76, 0)
            background_down:''
            
      
        Label:
            size_hint_y: .2
            text: ""
            color: rgba(Colors.BLUE)
            pos_hint: {'center_x': 0.5, "y": 1}
            markup: True
            on_ref_press:
                import webbrowser
                webbrowser.open("https://forms.gle/hqFUxiabb4gcEFU37")
